# Colleges Module Setup Guide

## 🎓 Overview

The Colleges module provides a complete CRUD interface for managing college information, including logos, images, and rich text content. This module includes:

- ✅ Full CRUD operations (Create, Read, Update, Delete)
- ✅ Search and pagination
- ✅ Status management (Active/Inactive)
- ✅ File uploads for logos and images
- ✅ Rich text editor support
- ✅ Responsive design

## 🗄️ Database Schema

The module uses the existing `College` table:

```sql
create table public."College" (
  id bigint generated by default as identity not null,
  logo text null,
  images text[] null,
  name text null,
  location text null,
  about text null,
  "courseAndFees" text null,
  hostel text null,
  "placementAndScholarship" text null,
  created_at timestamp with time zone not null default now(),
  "nirfRanking" bigint null,
  status boolean null default true,
  constraint College_pkey primary key (id)
) TABLESPACE pg_default;
```

## 📁 Supabase Storage Setup

### Required Buckets

You need to create two storage buckets in your Supabase project:

#### 1. college_logo
```sql
-- Create bucket for college logos
INSERT INTO storage.buckets (id, name, public) 
VALUES ('college_logo', 'college_logo', true);
```

#### 2. college_images
```sql
-- Create bucket for college images
INSERT INTO storage.buckets (id, name, public) 
VALUES ('college_images', 'college_images', true);
```

### Storage Policies

Create RLS policies for the storage buckets:

```sql
-- Allow public read access to college_logo
CREATE POLICY "Public read access for college_logo" ON storage.objects 
FOR SELECT USING (bucket_id = 'college_logo');

-- Allow authenticated insert for college_logo
CREATE POLICY "Authenticated insert for college_logo" ON storage.objects 
FOR INSERT WITH CHECK (bucket_id = 'college_logo' AND auth.role() = 'authenticated');

-- Allow authenticated update for college_logo
CREATE POLICY "Authenticated update for college_logo" ON storage.objects 
FOR UPDATE USING (bucket_id = 'college_logo' AND auth.role() = 'authenticated');

-- Allow authenticated delete for college_logo
CREATE POLICY "Authenticated delete for college_logo" ON storage.objects 
FOR DELETE USING (bucket_id = 'college_logo' AND auth.role() = 'authenticated');

-- Similar policies for college_images
CREATE POLICY "Public read access for college_images" ON storage.objects 
FOR SELECT USING (bucket_id = 'college_images');

CREATE POLICY "Authenticated insert for college_images" ON storage.objects 
FOR INSERT WITH CHECK (bucket_id = 'college_images' AND auth.role() = 'authenticated');

CREATE POLICY "Authenticated update for college_images" ON storage.objects 
FOR UPDATE USING (bucket_id = 'college_images' AND auth.role() = 'authenticated');

CREATE POLICY "Authenticated delete for college_images" ON storage.objects 
FOR DELETE USING (bucket_id = 'college_images' AND auth.role() = 'authenticated');
```

## 🚀 Features

### 📊 Colleges Table
- **Search**: Search by college name or location
- **Filter**: Filter by status (All/Active/Inactive)
- **Pagination**: 10 items per page
- **Actions**: Edit, Delete, Toggle Status
- **Responsive**: Works on all screen sizes

### 📝 College Form
- **Basic Info**: Name, Location, NIRF Ranking, Status
- **Logo Upload**: File upload or URL input
- **Multiple Images**: File upload or URL input
- **Rich Text Fields**: About, Courses & Fees, Hostel, Placement & Scholarship
- **Validation**: Required fields and error handling

### 🔧 API Endpoints

#### GET /api/colleges
```typescript
// Query parameters:
// - page: number (default: 1)
// - limit: number (default: 10)
// - search: string (searches name and location)
// - status: 'ALL' | 'ACTIVE' | 'INACTIVE'

// Response:
{
  success: true,
  data: College[],
  pagination: {
    page: number,
    limit: number,
    total: number,
    totalPages: number,
    hasNext: boolean,
    hasPrev: boolean
  }
}
```

#### POST /api/colleges
```typescript
// Create new college
// Body: Partial<College>
// Response: { success: true, data: College, message: string }
```

#### GET /api/colleges/[id]
```typescript
// Get single college
// Response: { success: true, data: College }
```

#### PUT /api/colleges/[id]
```typescript
// Update college
// Body: Partial<College>
// Response: { success: true, data: College, message: string }
```

#### DELETE /api/colleges/[id]
```typescript
// Delete college
// Response: { success: true, message: string }
```

## 📂 File Structure

```
app/
├── colleges/
│   └── page.tsx                    # Main colleges page
├── api/
│   └── colleges/
│       ├── route.ts                # GET (list), POST (create)
│       └── [id]/
│           └── route.ts            # GET, PUT, DELETE single college

components/
└── admin/
    ├── colleges-table.tsx          # Main table component
    └── college-form.tsx            # Add/Edit form component

lib/
├── supabase.ts                     # Database types and client
└── storage.ts                      # File upload utilities
```

## 🎨 UI Components Used

- `Card` - Container components
- `Table` - Data display
- `Input` - Text inputs
- `Textarea` - Rich text fields
- `Button` - Actions
- `Select` - Dropdowns
- `Badge` - Status indicators
- `Switch` - Toggle status
- `Label` - Form labels

## 📱 Navigation

The Colleges menu item has been added to the sidebar navigation:
- **Location**: Overview section
- **Icon**: GraduationCap (Lucide)
- **Route**: `/colleges`

## 🔒 Security Notes

- **TODO**: Add admin authentication middleware to all API routes
- **RLS**: Supabase Row Level Security should be configured for production
- **File Uploads**: Consider file size limits and virus scanning for production
- **Validation**: Server-side validation is implemented for all fields

## 🎯 Usage Examples

### Adding a New College
1. Navigate to `/colleges`
2. Click "Add College" button
3. Fill in required fields (Name, Location)
4. Upload logo and images (optional)
5. Add rich text content for About, Courses, etc.
6. Set status and submit

### Rich Text Formatting
The rich text fields support basic HTML:
- `<p>` - Paragraphs
- `<br>` - Line breaks
- `<strong>` - Bold text
- `<em>` - Italic text
- `<ul>`, `<li>` - Lists
- `<a href="">` - Links

### File Uploads
- **Logo**: Single file upload to `college_logo` bucket
- **Images**: Multiple file upload to `college_images` bucket
- **Formats**: Accepts all image formats (jpg, png, gif, etc.)
- **Fallback**: Can also use direct URLs instead of file upload

## 🔧 Customization

### Adding More Rich Text Features
To enhance the rich text editor, consider integrating:
- **TinyMCE**: Full-featured WYSIWYG editor
- **Quill**: Modern rich text editor
- **Tiptap**: Headless editor framework

### Extending Search
Current search covers name and location. To add more fields:
```typescript
// In /api/colleges/route.ts
query = query.or(`name.ilike.%${searchTerm}%,location.ilike.%${searchTerm}%,about.ilike.%${searchTerm}%`)
```

### Adding More Filters
To add course type or ranking filters:
```typescript
// Add to STATUS_OPTIONS array
const COURSE_OPTIONS = [
  { value: 'ALL', label: 'All Courses' },
  { value: 'ENGINEERING', label: 'Engineering' },
  { value: 'MEDICAL', label: 'Medical' },
  // ...
]
```

## ✅ Testing Checklist

- [ ] Create new college
- [ ] Upload logo file
- [ ] Upload multiple images
- [ ] Edit college details
- [ ] Toggle status (Active/Inactive)
- [ ] Search by name
- [ ] Search by location
- [ ] Filter by status
- [ ] Pagination navigation
- [ ] Delete college
- [ ] Form validation
- [ ] File upload error handling
- [ ] Responsive design testing

---

The Colleges module is now fully functional and ready for use! 🎉
